@model SAM.ViewModels.UserManagement.UserDetailsViewModel
@using Microsoft.AspNetCore.Identity
@using SAM.Domain.Entities
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = "User Details";
    var user = await UserManager.GetUserAsync(User);
    var canEdit = user != null && await UserManager.IsInRoleAsync(user, "admin");
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <p class="text-muted mb-0">View detailed information for user account</p>
    </div>
    <div>
        @if (canEdit)
        {
            <a asp-action="UserEdit" asp-route-id="@Model.Id" class="btn btn-primary">
                <i class="bi bi-pencil"></i> Edit
            </a>
        }
        <a asp-action="Users" asp-route-companyId="@Model.CompanyId" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back to List
        </a>
    </div>
</div>

<div class="card card-primary">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-person me-2"></i>@Model.FullName</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3"><i class="bi bi-envelope me-1"></i>Email:</dt>
            <dd class="col-sm-9">@Model.Email</dd>

            <dt class="col-sm-3"><i class="bi bi-person me-1"></i>Full Name:</dt>
            <dd class="col-sm-9">@Model.FullName</dd>

            <dt class="col-sm-3"><i class="bi bi-briefcase me-1"></i>Company:</dt>
            <dd class="col-sm-9">@(Model.CompanyName ?? "N/A")</dd>

            <dt class="col-sm-3"><i class="bi bi-person-badge me-1"></i>Role(s):</dt>
            <dd class="col-sm-9">
                @foreach (var role in Model.Roles)
                {
                    <span class="badge bg-secondary me-1">@role.Replace("_", " ")</span>
                }
            </dd>

            <dt class="col-sm-3"><i class="bi bi-check-circle me-1"></i>Status:</dt>
            <dd class="col-sm-9">
                @if (Model.IsActive)
                {
                    <span class="badge bg-success">Active</span>
                }
                else
                {
                    <span class="badge bg-secondary">Inactive</span>
                }
            </dd>

            <dt class="col-sm-3"><i class="bi bi-envelope-check me-1"></i>Email Confirmed:</dt>
            <dd class="col-sm-9">@(Model.EmailConfirmed ? "Yes" : "No")</dd>

            @if (!string.IsNullOrWhiteSpace(Model.PhoneNumber))
            {
                <dt class="col-sm-3"><i class="bi bi-telephone me-1"></i>Phone Number:</dt>
                <dd class="col-sm-9">@Model.PhoneNumber</dd>
            }

            @if (Model.CreatedDate.HasValue)
            {
                <dt class="col-sm-3"><i class="bi bi-calendar-plus me-1"></i>Created Date:</dt>
                <dd class="col-sm-9">@Model.CreatedDate.Value.ToString("MM/dd/yyyy HH:mm") UTC</dd>
            }

            @if (Model.UpdatedDate.HasValue)
            {
                <dt class="col-sm-3"><i class="bi bi-calendar-check me-1"></i>Updated Date:</dt>
                <dd class="col-sm-9">@Model.UpdatedDate.Value.ToString("MM/dd/yyyy HH:mm") UTC</dd>
            }
        </dl>
    </div>
</div>

