@model SAM.ViewModels.OperationalData.IrrigateViewModel
@using Microsoft.AspNetCore.Identity
@using SAM.Domain.Entities
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = "Irrigation Log Details";
    var user = await UserManager.GetUserAsync(User);
    var canEdit = user != null && (await UserManager.IsInRoleAsync(user, "admin") || await UserManager.IsInRoleAsync(user, "company_admin") || await UserManager.IsInRoleAsync(user, "operator"));
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <p class="text-muted mb-0">View detailed information for irrigation log</p>
    </div>
    <div>
        @if (canEdit)
        {
            <a asp-action="IrrigateEdit" asp-route-id="@Model.Id" class="btn btn-primary">
                <i class="bi bi-pencil"></i> Edit
            </a>
        }
        <a asp-action="Irrigates" asp-route-companyId="@Model.CompanyId" asp-route-facilityId="@Model.FacilityId" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back to List
        </a>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Basic Information</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Date:</dt>
            <dd class="col-sm-9">@Model.IrrigationDate.ToString("MM/dd/yyyy")</dd>

            <dt class="col-sm-3">Facility:</dt>
            <dd class="col-sm-9">@Model.FacilityName</dd>

            <dt class="col-sm-3">Sprayfield:</dt>
            <dd class="col-sm-9">@Model.SprayfieldName</dd>

            <dt class="col-sm-3">Company:</dt>
            <dd class="col-sm-9">@Model.CompanyName</dd>
        </dl>
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h5 class="mb-0">Time & Duration</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Start Time:</dt>
            <dd class="col-sm-9">@Model.StartTime</dd>

            <dt class="col-sm-3">End Time:</dt>
            <dd class="col-sm-9">@Model.EndTime</dd>

            <dt class="col-sm-3">Duration:</dt>
            <dd class="col-sm-9">@(Model.DurationHours?.ToString("F2") ?? "N/A") hours</dd>
        </dl>
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h5 class="mb-0">Flow & Volume</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Flow Rate:</dt>
            <dd class="col-sm-9">@(Model.FlowRateGpm?.ToString("F2") ?? "N/A") gpm</dd>

            <dt class="col-sm-3">Total Volume:</dt>
            <dd class="col-sm-9">@(Model.TotalVolumeGallons?.ToString("N0") ?? "N/A") gallons</dd>

            <dt class="col-sm-3">Application Rate:</dt>
            <dd class="col-sm-9">@(Model.ApplicationRateInches?.ToString("F2") ?? "N/A") inches</dd>
        </dl>
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h5 class="mb-0">Weather Conditions</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Precipitation (in):</dt>
            <dd class="col-sm-9">@(Model.PrecipitationIn.HasValue ? Model.PrecipitationIn.Value.ToString("F2") + " in" : "N/A")</dd>

            <dt class="col-sm-3">Temperature (°F):</dt>
            <dd class="col-sm-9">@(Model.TemperatureF.HasValue ? Model.TemperatureF.Value.ToString("F1") + " °F" : "N/A")</dd>

            <dt class="col-sm-3">Weather Conditions:</dt>
            <dd class="col-sm-9">@(string.IsNullOrEmpty(Model.WeatherConditions) ? "N/A" : Model.WeatherConditions)</dd>
        </dl>
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h5 class="mb-0">Additional Information</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Modified by:</dt>
            <dd class="col-sm-9">@(string.IsNullOrEmpty(Model.ModifiedBy) ? "N/A" : Model.ModifiedBy)</dd>

            <dt class="col-sm-3">Comments:</dt>
            <dd class="col-sm-9">@(string.IsNullOrEmpty(Model.Comments) ? "N/A" : Model.Comments)</dd>
        </dl>
    </div>
</div>

